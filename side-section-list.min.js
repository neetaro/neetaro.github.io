$(window).on("load",function(){function e(){return $("html,body").animate({scrollTop:$(this.hash).offset().top-globalMuneHeight},300,"swing"),window.history.pushState(null,null,this.hash),!1}if($("body").hasClass("page-entry")){var t=$("#sectionListSide"),o=document.getElementById("main-inner"),n="h2,h3,h4,h5,h6",i=[],s=0,r=[],a=o.getElementsByClassName("table-of-contents"),l=[],c=!1;if(a.length){for(var h=a[0].getElementsByTagName("a"),d=h[0].href.split("#")[0].length+1,f=0,u=h.length;u>f;f++)l.push(h[f].href.slice(d)),h[f].addEventListener("click",e);c=!0}if($.each(o.getElementsByClassName("entry-content")[0].querySelectorAll(n),function(e){var t=this,o="section"+e,n=0;for(c?o=l[e]:$(t).attr("id",o),i.push('<li><a href="#'+o+'">'+$(t).text()+"</a>"),"h3"==t.nodeName.toLowerCase()?n=1:"h4"==t.nodeName.toLowerCase()?n=2:"h5"==t.nodeName.toLowerCase()?n=3:"h6"==t.nodeName.toLowerCase()&&(n=4);n>s;)i[e]='<ol class="chapter">'+i[e],s++;for(;s>n;)i[e]="</ol></li>"+i[e],s--;r[e]=$(t).offset().top}),i.length<2)return void console.log("--toc hide--");var p=($("#box2").outerHeight(!0),t.parent().parent());p.outerHeight(!0);t.parent().before('<div class="hatena-module-title">目次</div>'),t.append('<div class="sectionList"><ol>'+i.join("")+"</ol></div>");var g=$("a",t);g.on("click",e);var v=10;p.css("width",p.width()),$("#box2-inner").css({position:"relative"});var m=$("#globalheader-container"),w="fixed"===m.css("position")?m.outerHeight(!0):0,b=p.offset().top-w-v,y=$("#container-inner").offset().top+$("#container-inner").outerHeight(!0)-p.outerHeight();console.log("SCROLL_FIXED:"+b),console.log("SCROLL_ABSOLUTE:"+y);var L=$(window),C=50,x=r.length-1,E=$(document).height()-L.height(),N=function(){var e=-1;return function(t){t!=e&&(e=t,g.removeClass("current"),g.eq(t).addClass("current"))}}();N(0);var H=function(){var e=-1;return function(t){return t!=e?(e=t,!0):void 0}}();L.scroll(function(){var e=$(window).width(),t=910;if(t>e)return void p.css({display:"none"});p.css({display:"block"});var o=L.scrollTop();if(C>=o)N(0);else if(C>=E-o)N(x);else for(var n=x;n>=0;n--)if(o>r[n]-C){N(n);break}o>y?H(0)&&p.css({position:"absolute",top:y+w-$("#box2").offset().top+v+"px"}):o>b?H(1)&&p.css({position:"fixed",top:w+v+"px"}):H(2)&&p.css({position:"static"})})}});